{% extends 'layouts/base-fullscreen.html' %}
{% load static %}

{% block title %}Login - MAXFER{% endblock %}

{% block stylesheets %}
<style>
  .login-wrapper {
    display: flex;
    flex-wrap: wrap;
    align-items: stretch;
    justify-content: center;
    width: 100%;
    max-width: 1000px;
    margin: auto;
  }

  .login-image {
    flex: 1;
    border-radius: 1rem 0 0 1rem;
    min-height: 500px;
  }

  .login-image img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 1rem 0 0 1rem;
  }

  .login-form {
    flex: 1;
    padding: 3rem;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(12px);
    border-radius: 0 1rem 1rem 0;
    color: #fff;
  }

  .login-form h3 {
    font-weight: 600;
    color: #fff;
  }

  .login-form label {
    color: #e2e8f0;
    margin-bottom: 0.25rem;
    display: block;
  }

  .login-form .btn {
    font-weight: 600;
    border: none;
  }
  .input-group-text {
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.15);
    border: 1px solid #dee2e6;
    color: #fff;
    border-radius: 0.25rem 0 0 0.25rem;
  }

  .form-control {
    background: rgba(255, 255, 255, 0.15);
    color: #fff;
    border: 1px solid #dee2e6;
    border-radius: 0 0.25rem 0.25rem 0;
  }
   .login-link {
    text-align: center;
    margin-top: 1rem;
  }

  .login-link a {
    color: #00d4ff;
    font-weight: 500;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .login-link a:hover {
    color: #00ffff;
    text-decoration: underline;
  }

  .text-error {
    color: #ff6b6b;
    font-size: 0.875rem;
    margin-top: 0.25rem;
  }

  @media (max-width: 768px) {
    .login-wrapper {
      flex-direction: column;
    }
    .login-image {
      display: none;
    }
    .login-form {
      border-radius: 1rem;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="login-wrapper shadow-lg">

  <div class="login-image">
    <img src="{% static 'img/brand/login.png' %}" alt="Logo">
  </div>

  <div class="login-form d-flex flex-column justify-content-center">
    <h3 class="mb-3 text-center">Bienvenido a <strong>MAXFER</strong></h3>
    <p class="text-center text-light mb-4">Inicia sesión para continuar</p>

    {% if msg %}
      <div class="text-error mb-3">{{ msg }}</div>
    {% endif %}

    <form method="post" action="{% url 'login' %}">
      {% csrf_token %}

      <div class="input-group mb-3">
        <span class="input-group-text">
          <i class="bi bi-person-fill"></i>
        </span>
        <input type="text" class="form-control" id="username" name="username" placeholder="Usuario" required>
      </div>
      {% for error in form.username.errors %}
        <div class="text-error">{{ error }}</div>
      {% endfor %}

      <div class="input-group mb-4">
        <span class="input-group-text">
          <i class="bi bi-lock-fill"></i>
        </span>
        <input type="password" class="form-control" id="password" name="password" placeholder="Contraseña" required>
        <span class="input-group-text" id="togglePassword" style="cursor: pointer;">
          <i class="bi bi-eye"></i>
        </span>
      </div>
      {% for error in form.password.errors %}
        <div class="text-error">{{ error }}</div>
      {% endfor %}

      <button class="btn btn-light w-100 py-2 mb-3" type="submit">Iniciar Sesión</button>
    </form>

    <p class="login-link text-center mt-3 mb-0">
      ¿No tienes una cuenta?
      <a href="{% url 'register' %}">Regístrate</a>
    </p>
  </div>
</div>
{% endblock %}

{% block javascripts %}
<script>
  const togglePassword = document.querySelector('#togglePassword');
  const passwordInput = document.querySelector('#password');

  togglePassword.addEventListener('click', function () {
    const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
    passwordInput.setAttribute('type', type);
    this.querySelector('i').classList.toggle('bi-eye');
    this.querySelector('i').classList.toggle('bi-eye-slash');
  });
</script>
{% endblock %}
